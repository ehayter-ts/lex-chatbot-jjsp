!function(){metadata={systemName:"AWS_Lex_ChatBot",displayName:"AWS Lex ChatBot Broker",description:"AWS Lex ChatBot Broker",configuration:{AwsRegion:{displayName:"AWS Region",type:"string",value:"eu-west-2"},BotName:{displayName:"Bot Name",type:"string",value:"MedicalBotNHS"},BotAlias:{displayName:"Bot Name",type:"string",value:"latestversion"},UserID:{displayName:"User ID",type:"string",value:"AKIARXLDA4AZB24QPA72"}}};var e=require("crypto-js");function t(){var e=new Date;return e.getFullYear().toString()+("0"+(e.getMonth()+1)).slice(-2).toString()+("0"+e.getDate()).slice(-2)}ondescribe=async function({configuration:e}){postSchema({objects:{Message:{displayName:"Message",description:"Represents a text reply",properties:{inputText:{displayName:"Input Text",type:"string"},outputText:{displayName:"Output Text",type:"string"}},methods:{postText:{displayName:"Post Text",type:"execute",inputs:["inputText"],outputs:["outputText"]}}}}})},onexecute=async function({objectName:a,methodName:s,parameters:o,properties:n,configuration:r,schema:i}){switch(a){case"message":await async function(a,s,o,n){switch(a){case"postText":await function(a,s){return new Promise((o,n)=>{var r=new XMLHttpRequest;r.onreadystatechange=function(){try{if(4!==r.readyState)return;if(200!==r.status)throw new Error("Failed with status "+r.status);var e=JSON.parse(r.responseText);postResult({outputText:e.message}),o()}catch(e){n(e)}};var i,u,p,c={inputText:a.inputText.toString()};r.open("POST",`https://runtime.lex.${s.AwsRegion}.amazonaws.com/bot/${s.BotName}/alias/${s.BotAlias}/user/${s.UserID}/text`),r.setRequestHeader("Authorization",`AWS4-HMAC-SHA256 Credential=${s.UserID}/${t()}/${s.AwsRegion}/lex/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=${i=e.HmacSHA256(t(),"AWS4"+metadata.configuration.UserID),u=e.HmacSHA256(metadata.configuration.AwsRegion,i),p=e.HmacSHA256("lex",u),e.HmacSHA256("aws4_request",p)}`),r.setRequestHeader("Content-Type","application/json"),r.send(JSON.stringify(c))})}(s,n);break;default:throw new Error("The method "+a+" is not supported.")}}(s,n,0,r);break;default:throw new Error("The object "+a+" is not supported.")}}}();
//# sourceMappingURL=index.js.map
