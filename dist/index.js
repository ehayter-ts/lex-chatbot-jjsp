!function(){var e=require("crypto-js");function t(){return(new Date).toISOString()}metadata={systemName:"AWS_Lex_ChatBot",displayName:"AWS Lex ChatBot Broker",description:"AWS Lex ChatBot Broker",configuration:{AwsRegion:{displayName:"AWS Region",type:"string",value:"eu-west-2"},BotName:{displayName:"Bot Name",type:"string",value:"MedicalBotNHS"},BotAlias:{displayName:"Bot Name",type:"string",value:"latestversion"},UserID:{displayName:"User ID",type:"string",value:"AKIARXLDA4AZB24QPA72"}}},ondescribe=async function({}){postSchema({objects:{message:{displayName:"Message",description:"Represents a text reply",properties:{inputText:{displayName:"Input Text",type:"string"},outputText:{displayName:"Output Text",type:"string"}},methods:{postText:{displayName:"Post Text",type:"execute",inputs:["inputText"],outputs:["outputText"]}}}}})},onexecute=async function({objectName:a,methodName:s,parameters:n,properties:o,configuration:r}){switch(a){case"message":await async function(a,s,n){switch(a){case"postText":await function(a,s){return new Promise((n,o)=>{var r=new XMLHttpRequest;r.onreadystatechange=function(){try{if(4!==r.readyState)return;if(200!==r.status)throw new Error("Failed with status "+r.status+" "+r.responseText);postResult({outputText:"Test"}),n()}catch(e){o(e)}};var i,u,p,c={inputText:a.inputText.toString()},d=JSON.stringify(c);r.open("POST",`https://runtime.lex.${s.AwsRegion}.amazonaws.com/bot/${s.BotName}/alias/${s.BotAlias}/user/${s.UserID}/text`),r.setRequestHeader("Authorization",`AWS4-HMAC-SHA256 Credential=${s.UserID}/20201021/${s.AwsRegion}/lex/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=${i=e.HmacSHA256(t(),"AWS4"+metadata.configuration.UserID),u=e.HmacSHA256(metadata.configuration.AwsRegion,i),p=e.HmacSHA256("lex",u),e.HmacSHA256("aws4_request",p)}`),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("X-Amz-Date",t()),r.setRequestHeader("X-Amz-Content-Sha256","beaead3198f7da1e70d03ab969765e0821b24fc913697e929e726aeaebf0eba3"),r.setRequestHeader("Content-Length",d.length.toString()),r.send(d)})}(s,n);break;default:throw new Error("The method "+a+" is not supported.")}}(s,o,r);break;default:throw new Error("The object "+a+" is not supported.")}}}();
//# sourceMappingURL=index.js.map
